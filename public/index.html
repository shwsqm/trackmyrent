<!doctype html>
<head>
  <title>TrackMyRent ‚Äî –£–ø—Ä–∞–≤–ª—è–π—Ç–µ –∞—Ä–µ–Ω–¥–æ–π –ª–µ–≥–∫–æ</title>
  <style>
:root {--bg: #f6f8fb;--accent: #2563eb;--accent2: #0a84ff;--card: #fff;--shadow: 0 4px 12px rgba(0,0,0,0.08);--radius: 10px;font-family: "Inter", system-ui, sans-serif;color: #111;}
body {background: var(--bg);margin: 0;animation: fadeIn 0.7s ease;}
@keyframes fadeIn {from { opacity: 0; transform: translateY(10px); }to { opacity: 1; transform: translateY(0); }}
.site-header {background: linear-gradient(90deg, var(--accent), var(--accent2));color: white;border-bottom: none;position: sticky; top: 0; z-index: 100;box-shadow: var(--shadow);animation: slideDown 0.6s ease;}
@keyframes slideDown {from { transform: translateY(-40px); opacity: 0; }to { transform: translateY(0); opacity: 1; }}
.header-inner {display: flex; align-items: center; justify-content: space-between;padding: 12px 20px;}
.logo-box {display: flex; align-items: center; gap: 10px;}
.logo {width: 50px; height: 50px; object-fit: contain; filter: drop-shadow(0 2px 3px rgba(0,0,0,0.3));}
h1 {margin: 0; font-size: 22px;}
.btn {background: var(--accent);border: none;color: white;padding: 8px 14px;border-radius: 6px;cursor: pointer;transition: all 0.25s ease;box-shadow: 0 2px 6px rgba(37,99,235,0.3);}
.btn:hover {transform: translateY(-2px) scale(1.03);box-shadow: 0 4px 12px rgba(37,99,235,0.4);}
.btn.ghost {background: transparent;border: 1px solid var(--accent);color: var(--accent);box-shadow: none;}
.btn.ghost:hover {background: var(--accent);color: white;transform: translateY(-2px);}
.btn.large {padding: 10px 20px; font-size: 16px;}
.btn.small {padding: 6px 10px; font-size: 14px;}
#get-started {animation: pulse 2s infinite;}
@keyframes pulse {0%, 100% { box-shadow: 0 0 0 0 rgba(37,99,235,0.4); }50% { box-shadow: 0 0 12px 4px rgba(37,99,235,0.25); }}
.container {max-width: 900px; margin: auto; padding: 20px;}
.hero {text-align: center; margin-top: 40px; animation: fadeIn 1s ease;}
.info-section {text-align: center; margin-top: 40px;}
.info-cards {display: grid;grid-template-columns: repeat(auto-fit, minmax(250px,1fr));gap: 16px;margin-top: 20px;}
.info-card {background: var(--card);border-radius: var(--radius);padding: 16px;box-shadow: var(--shadow);transition: transform 0.3s ease, box-shadow 0.3s ease;animation: fadeIn 1s ease;}
.info-card:hover {transform: translateY(-6px);box-shadow: 0 6px 20px rgba(0,0,0,0.12);}
.faq-section {margin-top: 40px; animation: fadeIn 1s ease;}
details {background: white;border-radius: 8px;box-shadow: 0 1px 2px rgba(0,0,0,0.05);margin-bottom: 10px;padding: 12px 16px;transition: all 0.3s;overflow: hidden;}
summary {cursor: pointer;font-weight: 600;color: var(--accent);display: flex;justify-content: space-between;align-items: center;list-style: none;}
summary::after {content: "‚ñº";font-size: 12px;color: var(--accent);transition: transform 0.3s;}
details[open] summary::after {transform: rotate(180deg);}
details p {margin-top: 8px;color: #374151;animation: fadeOpen 0.4s ease;}
@keyframes fadeOpen {from {opacity: 0; transform: translateY(-5px);}to {opacity: 1; transform: translateY(0);}}
details:hover {background: #f0f7ff;}
.modal {position: fixed;inset: 0;background: rgba(0,0,0,0.4);display: flex;justify-content: center;align-items: center;animation: fadeIn 0.3s ease;}
.modal-card {background: white;padding: 20px;border-radius: 10px;width: 300px;animation: pop 0.4s ease;}
@keyframes pop {from {transform: scale(0.8); opacity: 0;}to {transform: scale(1); opacity: 1;}}
footer {background: #fff;border-top: 1px solid #e5e7eb;text-align: center;padding: 20px;margin-top: 40px;animation: fadeIn 1s ease;}
footer button {margin: 4px;}
table {width: 100%;border-collapse: collapse;animation: fadeIn 0.5s ease;}
th, td {padding: 8px;border-bottom: 1px solid #e5e7eb;text-align: left;}
.card {background: white;padding: 16px;border-radius: 10px;box-shadow: var(--shadow);margin-top: 20px;animation: fadeIn 0.8s ease;}
.status-paid {color: green; font-weight: 600;}
.status-due {color: #dc2626; font-weight: 600;}
.summary-box {display: flex; gap: 16px; justify-content: center;margin-bottom: 10px; padding: 8px 0;background: #f5f5f5; border-radius: 8px;font-size: 15px; animation: fadeIn 1s ease;}
.hidden {display:none;}
  </style>
</head>
<body>
  <header class="site-header">
    <div class="container header-inner">
      <div class="logo-box">
        <img src="logo.png" alt="TrackMyRent" class="logo">
        <h1>TrackMyRent</h1>
      </div>
      <nav>
        <button id="btn-login" class="btn small">–í–æ–π—Ç–∏</button>
        <button id="btn-register" class="btn ghost small">–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è</button>
      </nav>
    </div>
  </header>
  <main>
    <section class="hero container" style="text-align:center; margin-top:40px;">
      <h2>–£–ø—Ä–∞–≤–ª—è–π—Ç–µ –∞—Ä–µ–Ω–¥–æ–π –∏ –¥–æ–ª–≥–∞–º–∏ –ª–µ–≥–∫–æ</h2>
      <p>TrackMyRent –ø–æ–º–æ–≥–∞–µ—Ç –∞—Ä–µ–Ω–¥–æ–¥–∞—Ç–µ–ª—è–º –∏ –∂–∏–ª—å—Ü–∞–º —É–¥–æ–±–Ω–æ –∫–æ–Ω—Ç—Ä–æ–ª–∏—Ä–æ–≤–∞—Ç—å –ø–ª–∞—Ç–µ–∂–∏, –¥–æ–ª–≥–∏ –∏ —Å—Ä–æ–∫–∏ –∞—Ä–µ–Ω–¥—ã.</p>
      <button id="get-started" class="btn large">–ù–∞—á–∞—Ç—å</button>
      <button class="btn ghost large">–ö–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç</button>
    </section>
    <section class="info-section container">
      <h3>–ü–æ—á–µ–º—É –≤—ã–±–∏—Ä–∞—é—Ç TrackMyRent?</h3>
      <div class="info-cards">
        <div class="info-card">
          <h4>üìä –£—á–µ—Ç –¥–æ–ª–≥–æ–≤</h4>
          <p>–õ–µ–≥–∫–æ –æ—Ç—Å–ª–µ–∂–∏–≤–∞–π—Ç–µ, –∫—Ç–æ –∏ —Å–∫–æ–ª—å–∫–æ –¥–æ–ª–∂–µ–Ω. –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –ø–æ–º–æ–≥–∞—é—Ç –Ω–µ –∑–∞–±—ã–≤–∞—Ç—å –æ —Å—Ä–æ–∫–∞—Ö.</p>
        </div>
        <div class="info-card">
          <h4>üí≥ –û–Ω–ª–∞–π–Ω –æ–ø–ª–∞—Ç–∞</h4>
          <p>–û–ø–ª–∞—á–∏–≤–∞–π—Ç–µ –∞—Ä–µ–Ω–¥—É –∏–ª–∏ –¥–æ–ª–≥–∏ –ø—Ä—è–º–æ –Ω–∞ —Å–∞–π—Ç–µ ‚Äî –∫–∞—Ä—Ç–æ–π –∏–ª–∏ –Ω–∞–ª–∏—á–Ω—ã–º–∏ –ø—Ä–∏ –≤—Å—Ç—Ä–µ—á–µ.</p>
        </div>
        <div class="info-card">
          <h4>üë• –†–∞–∑–Ω—ã–µ —Ä–æ–ª–∏</h4>
          <p>–ê—Ä–µ–Ω–¥–æ–¥–∞—Ç–µ–ª–∏ –∏ –∞—Ä–µ–Ω–¥–∞—Ç–æ—Ä—ã –∏–º–µ—é—Ç —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã–µ –ø–∞–Ω–µ–ª–∏ –∏ —Ñ—É–Ω–∫—Ü–∏–∏.</p>
        </div>
      </div>
    </section>
    <section class="faq-section container">
      <h3 style="text-align:center;">‚ùì –ß–∞—Å—Ç–æ –∑–∞–¥–∞–≤–∞–µ–º—ã–µ –≤–æ–ø—Ä–æ—Å—ã</h3>
      <details>
        <summary>–ö–∞–∫ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å—Å—è?</summary>
        <p>–ù–∞–∂–º–∏—Ç–µ ¬´–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è¬ª –≤–≤–µ—Ä—Ö—É, –≤–≤–µ–¥–∏—Ç–µ –ª–æ–≥–∏–Ω, –ø–∞—Ä–æ–ª—å –∏ –∏–º—è ‚Äî –≥–æ—Ç–æ–≤–æ!</p>
      </details>
      <details>
        <summary>–ú–æ–∂–Ω–æ –ª–∏ –æ–ø–ª–∞—Ç–∏—Ç—å –Ω–∞–ª–∏—á–Ω—ã–º–∏?</summary>
        <p>–î–∞! –ü—Ä–∏ –æ–ø–ª–∞—Ç–µ –≤—ã–±–µ—Ä–∏—Ç–µ —Å–ø–æ—Å–æ–± ¬´–ù–∞–ª–∏—á–Ω—ã–µ¬ª –∏ –æ—Ç–º–µ—Ç—å—Ç–µ, —á—Ç–æ –¥–æ–ª–≥ –ø–æ–≥–∞—à–µ–Ω –≤—Ä—É—á–Ω—É—é.</p>
      </details>
      <details>
        <summary>–ß—Ç–æ –¥–µ–ª–∞—Ç—å, –µ—Å–ª–∏ —è –∑–∞–±—ã–ª –ø–∞—Ä–æ–ª—å?</summary>
        <p>–°–≤—è–∂–∏—Ç–µ—Å—å —Å –∞–¥–º–∏–Ω–æ–º, —á—Ç–æ–±—ã –æ–Ω —Å–±—Ä–æ—Å–∏–ª –ø–∞—Ä–æ–ª—å –≤—Ä—É—á–Ω—É—é (—Ñ—É–Ω–∫—Ü–∏—è –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è –ø–æ–∫–∞ –Ω–µ –¥–æ—Å—Ç—É–ø–Ω–∞).</p>
      </details>
      <details>
        <summary>–ö—Ç–æ –º–æ–∂–µ—Ç –¥–æ–±–∞–≤–ª—è—Ç—å –¥–æ–ª–≥–∏?</summary>
        <p>–¢–æ–ª—å–∫–æ –∞–¥–º–∏–Ω –∏–º–µ–µ—Ç –ø—Ä–∞–≤–æ —Å–æ–∑–¥–∞–≤–∞—Ç—å –∏ —É–¥–∞–ª—è—Ç—å –¥–æ–ª–≥–∏, —á—Ç–æ–±—ã —Å–æ—Ö—Ä–∞–Ω—è–ª–∞—Å—å —á–µ—Å—Ç–Ω–æ—Å—Ç—å —Å–∏—Å—Ç–µ–º—ã.</p>
      </details>
      <div style="text-align:center; margin-top:20px;">
        <button class="btn ghost small" id="faq-toggle">–ü–æ–∫–∞–∑–∞—Ç—å / —Å–∫—Ä—ã—Ç—å –≤—Å–µ</button>
      </div>
    </section>
    <section class="dashboard container">
      <div id="msg" class="hidden"></div>
      <div id="no-user" class="card notice">
        <p>–í–æ–π–¥–∏—Ç–µ –∏–ª–∏ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–π—Ç–µ—Å—å. <br><b>–ê–¥–º–∏–Ω:</b> admin / <i>adminsecret</i></p>
      </div>
      <div id="user-panel" class="hidden">
        <div class="panel-top">
          <p>üëã –ü—Ä–∏–≤–µ—Ç, <b id="user-name"></b> (<span id="user-role"></span>)</p>
          <button id="btn-logout" class="btn ghost small">–í—ã–π—Ç–∏</button>
        </div>
        <div id="admin-panel" class="card hidden">
          <h4>–ê–¥–º–∏–Ω –ø–∞–Ω–µ–ª—å</h4>
          <form id="add-debt-form" class="form-row">
            <input id="debt-name" placeholder="–ò–º—è">
            <input id="debt-id" placeholder="ID">
            <input id="debt-date" type="date">
            <input id="debt-amount" placeholder="–°—É–º–º–∞ (—Å—É–º)" type="number" min="0">
            <input id="debt-expire" type="date">
            <button class="btn small">–î–æ–±–∞–≤–∏—Ç—å</button>
          </form>
        </div>
        <div class="card">
          <div id="summary"></div>
          <table id="debts-table">
            <thead>
              <tr><th>–ò–º—è</th><th>ID</th><th>–î–∞—Ç–∞</th><th>–°—É–º–º–∞</th><th>–°—Ä–æ–∫</th><th>–°—Ç–∞—Ç—É—Å</th><th>–î–µ–π—Å—Ç–≤–∏–µ</th></tr>
            </thead>
            <tbody></tbody>
          </table>
        </div>
      </div>
    </section>
  </main>
  <footer>
    <p>¬© 2025 TrackMyRent. –í—Å–µ –ø—Ä–∞–≤–∞ –∑–∞—â–∏—â–µ–Ω—ã.</p>
    <button class="btn ghost small">–û –Ω–∞—Å</button>
    <button class="btn ghost small">–ö–æ–Ω—Ç–∞–∫—Ç—ã</button>
  </footer>
  <div id="modal-root"></div>
  <script>
const $ = s => document.querySelector(s),
      $$ = s => document.querySelectorAll(s);
let session = null;
let debts = [];
const API = "http://trackmyrent.onrender.com/";
const msg = t => {
  const m = $('#msg');
  m.textContent = t;
  m.classList.remove('hidden');
  setTimeout(() => m.classList.add('hidden'), 2000);
};
function updateNav() {
  const n = document.querySelector('nav');
  if (!session) {
    n.innerHTML = `
      <button id="btn-login" class="btn small">–í–æ–π—Ç–∏</button>
      <button id="btn-register" class="btn ghost small">–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è</button>`;
    $('#btn-login').onclick = login;
    $('#btn-register').onclick = register;
  } else {
    n.innerHTML = `
      <span class="user-info">${session.name}</span>
      <button id="btn-logout" class="btn ghost small">–í—ã–π—Ç–∏</button>`;
    $('#btn-logout').onclick = () => { session = null; renderDebts(); msg('–í—ã –≤—ã—à–ª–∏'); };
  }
}
async function renderDebts() {
  const tb = $('#debts-table tbody');
  if (!tb) return;
  tb.innerHTML = '';
  updateNav();
  if (!session) {
    $('#no-user').classList.remove('hidden');
    $('#user-panel').classList.add('hidden');
    return;
  }
  $('#no-user').classList.add('hidden');
  $('#user-panel').classList.remove('hidden');
  $('#user-name').textContent = session.name;
  $('#user-role').textContent = session.role;
  $('#admin-panel').classList.toggle('hidden', session.role !== 'admin');
  const res = await fetch(`${API}/debts?username=${session.username}&role=${session.role}`);
  debts = await res.json();
  if (!debts.length) {
    tb.innerHTML = `<tr><td colspan=7>–ù–µ—Ç –¥–æ–ª–≥–æ–≤</td></tr>`;
    $('#summary').innerHTML = '';
    return;
  }
  tb.innerHTML = debts.map(d => `
    <tr>
      <td>${d.name}</td>
      <td>${d.debt_id}</td>
      <td>${d.date}</td>
      <td>${Number(d.amount).toLocaleString()} —Å—É–º</td>
      <td>${d.expire}</td>
      <td class="${d.status === 'paid' ? 'status-paid' : 'status-due'}">
        ${d.status === 'paid' ? `–æ–ø–ª–∞—á–µ–Ω–æ (${d.method === 'cash' ? '–Ω–∞–ª–∏—á–Ω—ã–º–∏' : '–∫–∞—Ä—Ç–æ–π'})` : '–Ω–µ –æ–ø–ª–∞—á–µ–Ω–æ'}
      </td>
      <td>
        ${d.status === 'due' ? `<button class="btn small pay" data-id="${d.id}">–û–ø–ª–∞—Ç–∏—Ç—å</button>` : '‚Äî'}
        ${session.role === 'admin' ? `<button class="btn ghost small del" data-id="${d.id}">–£–¥–∞–ª–∏—Ç—å</button>` : ''}
      </td>
    </tr>`).join('');
  $$('.pay').forEach(b => b.onclick = () => payModal(debts.find(x => x.id == b.dataset.id)));
  $$('.del').forEach(b => b.onclick = async () => {
    await fetch(`${API}/debts/${b.dataset.id}`, { method: 'DELETE' });
    renderDebts();
    msg('–£–¥–∞–ª–µ–Ω–æ');
  });
  if (session.role === 'admin') {
    const paidCard = debts.filter(d => d.status === 'paid' && d.method === 'card').length;
    const paidCash = debts.filter(d => d.status === 'paid' && d.method === 'cash').length;
    const unpaid = debts.filter(d => d.status === 'due').length;
    $('#summary').innerHTML = `
      <div class="summary-box">
        <span>üí≥ –ö–∞—Ä—Ç–æ–π: <b>${paidCard}</b></span>
        <span>üíµ –ù–∞–ª–∏—á–Ω—ã–º–∏: <b>${paidCash}</b></span>
        <span>‚è≥ –ù–µ –æ–ø–ª–∞—á–µ–Ω–æ: <b>${unpaid}</b></span>
      </div>`;
  } else {
    $('#summary').innerHTML = '';
  }
}
function payModal(d) {
  $('#modal-root').innerHTML = `
  <div class="modal"><div class="modal-card">
    <h3>–í—ã–±–µ—Ä–∏—Ç–µ —Å–ø–æ—Å–æ–± –æ–ø–ª–∞—Ç—ã ‚Äî ${d.name}</h3>
    <p><b>${Number(d.amount).toLocaleString()} —Å—É–º</b></p>
    <div style="display:flex;gap:8px;justify-content:center;margin-top:10px;">
      <button id="pay-card" class="btn small">–ö–∞—Ä—Ç–æ–π</button>
      <button id="pay-cash" class="btn small ghost">–ù–∞–ª–∏—á–Ω—ã–º–∏</button>
    </div>
    <div style="margin-top:10px;text-align:right;">
      <button id="cancel" class="btn ghost small">–û—Ç–º–µ–Ω–∞</button>
    </div>
  </div></div>`;

  $('#cancel').onclick = () => $('#modal-root').innerHTML = '';
  $('#pay-card').onclick = () => payDebt(d.id, 'card');
  $('#pay-cash').onclick = () => payDebt(d.id, 'cash');
}
async function payDebt(id, method) {
  await fetch(`${API}/debts/${id}/pay`, {
    method: 'PUT',
    headers: { 'Content-Type': 'application/json' },
    body: JSON.stringify({ method })
  });
  $('#modal-root').innerHTML = '';
  renderDebts();
  msg(method === 'card' ? '–û–ø–ª–∞—Ç–∞ –∫–∞—Ä—Ç–æ–π' : '–û–ø–ª–∞—Ç–∞ –Ω–∞–ª–∏—á–Ω—ã–º–∏');
}
async function login() {
  const username = prompt("–õ–æ–≥–∏–Ω:");
  const password = prompt("–ü–∞—Ä–æ–ª—å:");
  const res = await fetch(`${API}/login`, {
    method: 'POST',
    headers: { "Content-Type": "application/json" },
    body: JSON.stringify({ username, password })
  });
  const data = await res.json();
  if (data.error) return msg(data.error);
  session = data;
  renderDebts();
  msg("–í—Ö–æ–¥ –≤—ã–ø–æ–ª–Ω–µ–Ω");
}
async function register() {
  const username = prompt("–ù–æ–≤—ã–π –ª–æ–≥–∏–Ω:");
  const password = prompt("–ü–∞—Ä–æ–ª—å:");
  const name = prompt("–í–∞—à–µ –∏–º—è:");
  if (!username || !password || !name) return msg("–í–≤–µ–¥–∏—Ç–µ –≤—Å–µ –ø–æ–ª—è");
  const res = await fetch(`${API}/register`, {
    method: "POST",
    headers: { "Content-Type": "application/json" },
    body: JSON.stringify({ username, password, name })
  });
  const data = await res.json();
  if (data.error) return msg(data.error);
  msg("–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è —É—Å–ø–µ—à–Ω–∞");
}
$('#get-started')?.addEventListener('click', login);
$('#faq-toggle')?.addEventListener('click', () => {
  document.querySelectorAll('details').forEach(d => d.open = !d.open);
});
$('#add-debt-form')?.addEventListener('submit', async e => {
  e.preventDefault();
  const name = $('#debt-name').value.trim(),
        debt_id = $('#debt-id').value.trim(),
        date = $('#debt-date').value,
        amount = +$('#debt-amount').value,
        expire = $('#debt-expire').value;
  if (!name || !debt_id || !date || !amount || !expire) return msg('–í–≤–µ–¥–∏—Ç–µ –≤—Å–µ –¥–∞–Ω–Ω—ã–µ');
  await fetch(`${API}/debts`, {
    method: "POST",
    headers: { "Content-Type": "application/json" },
    body: JSON.stringify({ name, debt_id, date, amount, expire, owner: session.username })
  });
  e.target.reset();
  renderDebts();
  msg('–î–æ–±–∞–≤–ª–µ–Ω–æ');
});
renderDebts();
</script>
</body>
</html>